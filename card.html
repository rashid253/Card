<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Digital Card</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0f172a">

<style>
body{margin:0;font-family:system-ui;background:#f8fafc}
.top{
 background:#0f172a;color:white;
 padding:12px;display:flex;
 justify-content:space-around;
 font-size:20px
}
.top a{color:white;text-decoration:none}
.card{
 background:white;margin:15px;
 border-radius:16px;padding:15px
}
.profile{
 display:flex;gap:15px;align-items:center
}
.profile img{
 width:100px;height:100px;
 border-radius:50%;
 object-fit:cover
}
.offers{
 display:flex;overflow-x:auto;
 gap:12px;padding:15px
}
.offer{
 min-width:240px;
 background:white;
 border-radius:12px;
 padding:10px
}
.offer img{
 width:100%;
 height:140px;
 border-radius:10px;
 object-fit:cover
}
.offer button{
 width:100%;
 margin-top:8px;
 padding:10px;
 border:none;
 border-radius:8px;
 background:#2563eb;
 color:white
}
</style>
</head>

<body>

<div class="top">
<a id="shareBtn">ğŸ”—</a>
<a id="callBtn">ğŸ“</a>
<a id="waBtn">ğŸ’¬</a>
<a id="mapBtn">ğŸ“</a>
<a id="dirBtn">ğŸ§­</a>
</div>

<div class="card">
<div class="profile">
<img id="profileImg">
<div>
<h2 id="name"></h2>
<p id="businessName"></p>
<p id="address"></p>
</div>
</div>
<p id="businessInfo"></p>
</div>

<div class="offers" id="offers"></div>

<script src="https://unpkg.com/@supabase/supabase-js@2"></script>
<script>
const db = supabase.createClient(
 "https://dfvnefbxgayxqgjjgtrr.supabase.co",
 "sb_publishable_WypeFELCIlVDlqGY4PdWwA_snqoPUSE"
);

const id=new URLSearchParams(location.search).get("id");

db.from("cards").select("*").eq("id",id).single().then(r=>{
 const d=JSON.parse(r.data.data);

 name.innerText=d.name;
 businessName.innerText=d.businessName;
 address.innerText=d.address;
 businessInfo.innerText=d.businessInfo;
 profileImg.src=d.profileImage || "";

 callBtn.href="tel:"+d.phone;
 waBtn.href="https://wa.me/"+d.phone;
 mapBtn.href="https://maps.google.com?q="+encodeURIComponent(d.address);
 dirBtn.href="https://www.google.com/maps/dir/?api=1&destination="+encodeURIComponent(d.address);
 shareBtn.onclick=()=>navigator.share({url:location.href});

 d.offers.forEach(o=>{
  const div=document.createElement("div");
  div.className="offer";
  div.innerHTML=`
   <img src="${o.image}">
   <h4>${o.title}</h4>
   <p>${o.desc}</p>
   <button onclick="location.href='https://wa.me/${d.phone}?text=${encodeURIComponent(o.title)}'">
    Get Offer
   </button>
  `;
  offers.appendChild(div);
 });
});
</script>
</body>
</html>
