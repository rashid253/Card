<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Digital Card</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{margin:0;font-family:system-ui;background:#f8fafc}
.top{background:#0f172a;color:white;padding:12px;display:flex;justify-content:space-around}
.card{background:white;margin:15px;border-radius:14px;padding:15px}
.profile{display:flex;gap:15px;align-items:center}
.profile img{width:90px;height:90px;border-radius:50%;object-fit:contain}
.offers{display:flex;overflow-x:auto;gap:10px;margin-top:15px}
.offer{min-width:220px;background:#f1f5f9;border-radius:10px;padding:10px}
.offer img{width:100%;border-radius:8px}
</style>
</head>

<body>

<div class="top">
<a id="callBtn">Call</a>
<a id="waBtn">WhatsApp</a>
<a id="mapBtn">Map</a>
</div>

<div class="card">
<div class="profile">
<img id="profileImg">
<div>
<h2 id="name"></h2>
<p id="businessName"></p>
<p id="address"></p>
</div>
</div>

<p id="businessInfo"></p>
</div>

<div class="offers" id="offers"></div>

<script src="https://unpkg.com/@supabase/supabase-js@2"></script>
<script>
const db = supabase.createClient(
 "https://dfvnefbxgayxqgjjgtrr.supabase.co",
 "sb_publishable_WypeFELCIlVDlqGY4PdWwA_snqoPUSE"
);

const id=new URLSearchParams(location.search).get("id");

db.from("cards").select("*").eq("id",id).single().then(r=>{
 const d=JSON.parse(r.data.data);

 name.innerText=d.name;
 businessName.innerText=d.businessName;
 address.innerText=d.address;
 businessInfo.innerText=d.businessInfo;
 profileImg.src=d.profileImage || "";

 callBtn.href="tel:"+d.phone;
 waBtn.href="https://wa.me/"+d.phone;
 mapBtn.href="https://maps.google.com?q="+encodeURIComponent(d.address);

 d.offers.forEach(o=>{
  const div=document.createElement("div");
  div.className="offer";
  div.innerHTML=`
   <img src="${o.image}">
   <h4>${o.title}</h4>
   <p>${o.desc}</p>
  `;
  offers.appendChild(div);
 });
});
</script>
</body>
</html>
