<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Edit Digital Card</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{margin:0;font-family:system-ui;background:#f1f5f9}
.wrap{max-width:480px;margin:auto;padding:16px}
h2{margin-top:20px}

/* ONLY editor thumbnails */
.thumb{
  width:60px;
  height:60px;
  object-fit:cover;
  border-radius:8px;
  border:1px solid #ccc;
  display:block;
  margin-bottom:6px;
}

input,textarea{
 width:100%;
 padding:12px;
 margin-bottom:12px;
 border-radius:8px;
 border:1px solid #ccc;
 font-size:15px;
}
button{
 width:100%;
 padding:14px;
 background:#2563eb;
 color:#fff;
 border:none;
 border-radius:10px;
 font-size:16px;
}
</style>
</head>

<body class="editor">
<div class="wrap">

<h2>Edit Card</h2>

<label>Profile Image</label>
<img id="thumb1" class="thumb">
<input type="file" accept="image/*" onchange="updateThumb(this,'thumb1')">

<label>Cover Image</label>
<img id="thumb2" class="thumb">
<input type="file" accept="image/*" onchange="updateThumb(this,'thumb2')">

<label>Name</label>
<input id="name">

<label>Phone</label>
<input id="phone">

<label>Email</label>
<input id="email">

<label>Address</label>
<textarea id="address"></textarea>

<button onclick="saveData()">Save</button>

</div>

<script>
const id = new URLSearchParams(location.search).get("id");

const fields = ["name","phone","email","address"];

fields.forEach(f=>{
  document.getElementById(f).value =
    localStorage.getItem(id+"_"+f) || "";
});

if(localStorage.getItem(id+"_img1")){
  thumb1.src = localStorage.getItem(id+"_img1");
}
if(localStorage.getItem(id+"_img2")){
  thumb2.src = localStorage.getItem(id+"_img2");
}

/* Thumbnail update - no cache bug */
function updateThumb(input, imgId){
  const file = input.files[0];
  if(!file) return;

  const url = URL.createObjectURL(file);
  const img = document.getElementById(imgId);

  img.onload = ()=>URL.revokeObjectURL(url);
  img.src = url + "?t=" + Date.now();

  const reader = new FileReader();
  reader.onload = e=>{
    localStorage.setItem(
      id + "_" + (imgId=="thumb1"?"img1":"img2"),
      e.target.result
    );
  };
  reader.readAsDataURL(file);
}

function saveData(){
  fields.forEach(f=>{
    localStorage.setItem(id+"_"+f,
      document.getElementById(f).value);
  });
  location.href = "card.html?id=" + id;
}
</script>

</body>
</html>
