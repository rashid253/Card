<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Create Digital Card</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#2563eb">

<style>
body{margin:0;font-family:system-ui;background:#f1f5f9}
.wrap{max-width:480px;margin:auto;padding:16px}
h2,h3{margin-top:20px}

input,textarea{
 width:100%;padding:12px;margin:6px 0;
 border-radius:10px;border:1px solid #cbd5f5
}

button{
 width:100%;padding:16px;
 border:none;border-radius:12px;
 background:#2563eb;color:white;
 font-size:17px;margin-top:20px
}

.offerBox{
 background:white;padding:12px;
 border-radius:12px;margin-top:10px
}

/* GOOGLE STYLE BUSINESS HOURS */
.hoursBox{
 background:white;
 padding:12px;
 border-radius:12px;
 margin-top:10px
}

.hourRow{
 display:grid;
 grid-template-columns:26px 1fr 1fr;
 gap:6px;
 align-items:center;
 margin-bottom:6px
}

.hourRow input[type="checkbox"]{
 width:18px;height:18px
}

.timeRow{
 display:flex;
 gap:6px
}

.timeRow input{
 flex:1;
 padding:8px
}

.closedText{
 font-size:12px;
 color:#dc2626;
 font-weight:600
}
</style>

</head>

<body>
<div class="wrap">

<h2>Profile</h2>
<input type="file" id="profileImage" accept="image/*">
<input id="fullName" placeholder="Full Name">
<input id="phoneNumber" placeholder="Phone">
<input id="email" placeholder="Email">
<input id="address" placeholder="Address">

<h2>Business</h2>
<input id="businessName" placeholder="Business Title">
<textarea id="businessInfo" placeholder="About your business"></textarea>

<h3>Business Hours</h3>
<div class="hoursBox" id="hoursBox"></div>

<h2>Social Media</h2>
<input id="facebook" placeholder="Facebook link">
<input id="instagram" placeholder="Instagram link">
<input id="youtube" placeholder="YouTube link">
<input id="website" placeholder="Website link">

<h2>Shop App (Optional)</h2>
<input id="shopAppLink" placeholder="Play Store app link">
<input type="file" id="shopAppImage" accept="image/*">

<h2>Offers</h2>
<div id="offersForm"></div>

<button type="button" onclick="generate()">Generate Card</button>

</div>

<script src="https://unpkg.com/@supabase/supabase-js@2"></script>
<script>
const days=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];

days.forEach(d=>{
 hoursBox.innerHTML+=`
  <div class="hourRow">
   <input type="checkbox" id="open_${d}" checked>
   <strong>${d}</strong>
   <div class="timeRow">
    <input type="time" id="from_${d}" value="09:00">
    <input type="time" id="to_${d}" value="21:00">
   </div>
  </div>`;
});

/* OFFERS */
for(let i=1;i<=5;i++){
 offersForm.innerHTML+=`
 <div class="offerBox">
  <b>Offer ${i}</b>
  <input type="file" id="offerImg${i}">
  <input id="offerTitle${i}" placeholder="Title">
  <textarea id="offerDesc${i}" placeholder="Description"></textarea>
 </div>`;
}

function resizeImage(file){
 return new Promise(res=>{
  const img=new Image();
  img.onload=()=>{
   const c=document.createElement("canvas");
   const max=1024;
   let w=img.width,h=img.height;
   const r=Math.min(max/w,max/h,1);
   c.width=w*r; c.height=h*r;
   c.getContext("2d").drawImage(img,0,0,c.width,c.height);
   res(c.toDataURL("image/jpeg",0.8));
  }
  img.src=URL.createObjectURL(file);
 });
}

async function generate(){
 const name=fullName.value.trim();
 const phone=phoneNumber.value.trim();
 if(!name||!phone){alert("Name & Phone required");return;}

 const hours={};
 days.forEach(d=>{
  hours[d]={
   open:document.getElementById("open_"+d).checked,
   from:document.getElementById("from_"+d).value,
   to:document.getElementById("to_"+d).value
  };
 });

 const data={
  name,phone,
  email:email.value,
  address:address.value,
  businessName:businessName.value,
  business:{
   about:businessInfo.value,
   hours:hours
  },
  facebook:facebook.value,
  instagram:instagram.value,
  youtube:youtube.value,
  website:website.value,
  shopAppLink:shopAppLink.value,
  profileImage:"",
  shopAppImage:"",
  offers:[]
 };

 alert("Business info with Google style hours saved âœ”");
}
</script>
</body>
</html>
